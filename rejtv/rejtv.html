<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>SMYOZ – Rejtvények / megoldások</title>
<style>
  :root{
    --smy-brown: #5a3c32;
    --bg:#0b1220; --card:rgba(255,255,255,0.05); --txt:#eaf0ff; --muted:rgba(234,240,255,0.72);
    --line:rgba(255,255,255,0.16); --shadow:0 18px 40px rgba(0,0,0,0.45);
    --acc: rgba(183,255,178,0.16);
  }
  html,body{height:100%;}
  body{
    margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background:
      radial-gradient(1000px 600px at 80% 20%, rgba(183,255,178,0.12), transparent 60%),
      radial-gradient(800px 400px at 20% 90%, rgba(174,193,255,0.10), transparent 55%),
      var(--bg);
    color:var(--txt);
  }
  a{color:inherit;}
  .wrap{max-width: 820px; margin:0 auto; padding: 22px 14px 56px;}
  header{
    padding:16px 16px 14px; border:1px solid var(--line); border-radius:18px;
    background: rgba(255,255,255,0.04); box-shadow: var(--shadow);
  }
  h1{margin:0; font-size: 26px; letter-spacing:0.2px;}
  .sub{margin:8px 0 0; color:var(--muted); line-height:1.35;}
  .top-controls{margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;}
  .chip{
    border:1px solid var(--line); background:rgba(255,255,255,0.06); color:var(--txt);
    border-radius:999px; padding:8px 12px; font-weight:700; cursor:pointer;
  }
  .chip:focus{outline:2px solid rgba(183,255,178,0.35); outline-offset:2px;}
  .card{
    margin-top:14px; border:1px solid var(--line); border-radius:18px; background:var(--card);
    padding:14px 14px 12px; box-shadow: var(--shadow);
  }
  h2{margin:0 0 10px; font-size:18px;}
  .muted{color:var(--muted);}
  .btnrow{display:flex; flex-wrap:wrap; gap:10px; margin-top:10px;}
  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    padding:10px 12px; border-radius:12px;
    border:1px solid var(--line); background:rgba(255,255,255,0.06);
    text-decoration:none; font-weight:800;
  }
  .btn:hover{border-color: rgba(183,255,178,0.55);}
  .filelist{list-style:none; padding:0; margin:10px 0 0;}
  .filelist li{display:flex; align-items:center; justify-content:space-between; gap:10px;
    padding:8px 10px; border:1px solid rgba(255,255,255,0.09); border-radius:12px; margin:8px 0;
    background:rgba(0,0,0,0.18);
  }
  .filelist a{font-weight:800; text-decoration:none;}
  .ext{font-size:12px; color: var(--muted); flex:0 0 auto;}
  details.acc{
    border:1px solid rgba(255,255,255,0.12); border-radius:14px; overflow:hidden;
    background:rgba(0,0,0,0.16); margin-top:10px;
  }
  details.acc summary{
    cursor:pointer; padding:10px 12px; font-weight:900; list-style:none;
    background: linear-gradient(90deg, rgba(183,255,178,0.10), transparent);
  }
  details.acc[open] summary{background: linear-gradient(90deg, rgba(183,255,178,0.18), transparent);}
  .acc-body{padding: 10px 12px 12px;}
  .thumbgrid{display:grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap:10px; margin-top:10px;}
  .thumb{
    border:1px solid rgba(255,255,255,0.14); border-radius:12px; overflow:hidden; padding:0; background:transparent; cursor:pointer;
  }
  .thumb img{display:block; width:100%; height:78px; object-fit:cover;}
  .footer{margin-top:12px; color:var(--muted); font-size:13px; line-height:1.35;}
  body.hide-tech .ext{display:none;}
  body.hide-tech .tech{display:none;}

  /* SMYOZ: Vidámabb "környezetek" (téma-váltás). */
  body.theme-alap{ }
  body.theme-sunny{
    --bg:#fff3d6;
    --card: rgba(255,255,255,0.78);
    --txt:#181818;
    --muted:rgba(24,24,24,0.70);
    --line:rgba(24,24,24,0.14);
    --link:#ff7a59;
    --chip: rgba(0,0,0,0.05);
  }
  body.theme-mint{
    --bg:#0b1f1a;
    --card: rgba(255,255,255,0.05);
    --txt:#eaf0ff;
    --muted:rgba(234,240,255,0.72);
    --line:rgba(255,255,255,0.12);
    --link:#39d2c0;
    --chip: rgba(255,255,255,0.06);
  }
  body.theme-candy{
    --bg:#120a1e;
    --card: rgba(255,255,255,0.05);
    --txt:#eaf0ff;
    --muted:rgba(234,240,255,0.72);
    --line:rgba(255,255,255,0.12);
    --link:#ff7ad9;
    --chip: rgba(255,255,255,0.06);
  }

  body.theme-sunny{
    background: radial-gradient(1200px 650px at 20% 10%, rgba(255,122,89,0.18), transparent 60%),
                radial-gradient(1000px 650px at 80% 20%, rgba(58,210,159,0.18), transparent 60%),
                var(--bg);
  }
  body.theme-mint{
    background: radial-gradient(1200px 650px at 20% 10%, rgba(57,210,192,0.14), transparent 60%),
                radial-gradient(1000px 650px at 80% 20%, rgba(183,255,178,0.10), transparent 60%),
                var(--bg);
  }
  body.theme-candy{
    background: radial-gradient(1200px 650px at 20% 10%, rgba(255,122,217,0.14), transparent 60%),
                radial-gradient(1000px 650px at 80% 20%, rgba(141,214,255,0.12), transparent 60%),
                var(--bg);
  }

  /* Lightbox */
  .lb { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,0.82); z-index: 9999; padding:18px; }
  .lb.on { display:flex; }
  .lb-box { width:min(1200px, 98vw); height: min(95vh, 1080px); border:1px solid var(--line); border-radius:18px; overflow:hidden; background: rgba(15, 18, 26, 0.92); box-shadow: var(--shadow); display:flex; flex-direction:column; }
  .lb-top { display:flex; align-items:center; justify-content:space-between; padding: 10px 12px; border-bottom:1px solid var(--line); gap:10px; }
  .lb-cap { color: var(--muted); font-size:13px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
  .lb-actions { display:flex; gap:8px; }
  .lb-btn { border:1px solid var(--line); background: rgba(255,255,255,0.06); color: var(--txt); border-radius:10px; padding:8px 10px; font-weight:800; cursor:pointer; }
  .lb-body { flex:1 1 auto; display:flex; align-items:center; justify-content:center; padding:10px; }
  #lbImg { max-width:100%; max-height:100%; border-radius:12px; }

/* SMYOZ: technikai (apróbetűs) blokkok végleges elrejtése */
.tech, .technical, .debug, .fineprint, #tech, #technical, #debug { display:none !important; }



/* VW villanás-gátló: iframe csak betöltés után látszik */
  position:absolute; inset:0;
  display:none;
  align-items:center; justify-content:center;
  font-weight:800;
  color: rgba(240,244,255,0.92);
  background: rgba(12,14,18,0.92);
  border-radius: 0 0 12px 12px;
  z-index: 2;
}



/* HONLAP-260103_12: Rejtvények almenük – nyitott állapotban nagyobb indent + eltérő kiemelés */
details.acc{ position:relative; }
details.acc[open]{
  margin-left: 18px;
  border-left: 4px solid rgba(183,255,178,0.30);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.08);
}
details.acc[open] summary{
  color: rgba(234,240,255,0.96);
}
details.acc[open] .acc-body{
  padding-left: 16px;
}
details.acc[open] .filelist{
  margin-left: 0;
}


  .btnMini{
    margin-left: 10px;
    padding: 3px 8px;
    border: 1px solid rgba(0,0,0,0.25);
    border-radius: 10px;
    background: rgba(255,255,255,0.65);
    cursor: pointer;
    font-size: 12px;
    line-height: 1.2;
    white-space: nowrap;
  }
  .btnMini:hover{ background: rgba(255,255,255,0.9); }</style>

<style id="SMYOZ_VW2_CSS">
/* SMYOZ VW2: egységes, honlap-szerű beágyazott néző (nincs külön felső barna csík) */
#vw2 {
  position: fixed; inset: 0;
  display: none;
  background: var(--smy-brown);
  z-index: 99999;
}
#vw2.on { display: block; }

#vw2Back {
  position: absolute;
  right: 12px;
  top: 10px;
  z-index: 2;
  background: transparent;
  color: #fff;
  border: 2px solid #fff;
  border-radius: 10px;
  padding: 4px 10px;
  font: 800 14px Arial, sans-serif;
  cursor: pointer;
}

#vw2Stage {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  background: var(--smy-brown);
  box-sizing: border-box;
  overflow: hidden;
}

#vw2Frame {
  width: 100%;
  height: 100%;
  border: 0;
  display: block;
  background: #fff;
}

#vw2Split {
  width: 100%;
  height: 100%;
  display: none;
  background: var(--smy-brown);
}
#vw2Split.on { display: flex; }
#vw2Left {
  width: 33.333%;
  height: 100%;
  background: var(--smy-brown);
}
#vw2Right {
  flex: 1;
  height: 100%;
  background: var(--smy-brown);
}
#vw2TxtFrame {
  width: 100%;
  height: 100%;
  border: 0;
  display: block;
  background: #fff;
}

/* --- VW2 TXT mód: nincs split (nincs üres fehér pacni), barna keret + nagyítás --- */
#vw2.txtmode #vw2Stage{
  /* 20mm körüli belső barna keret */
  box-sizing: border-box;
  padding: 20mm;
  background:/* #fff ; */ var(--smy-brown); /* csak a keret; maga a háttér a #vw2 */
}
#vw2.txtmode #vw2Frame{
  background:  #fff ; /* var(--smy-brown);
  /* kb. +50% olvashatóság (Firefox kompatibilis) */
  transform-origin: 0 0;
  transform: scale(1.5);
  width: calc(100% / 1.5);
  height: calc(100% / 1.5);
}
</style>

</head>
<body>
<div class="wrap">
  <header>
    <h1>SMYOZ – Rejtvények / megoldások</h1>
    <p class="sub tech">A lista a <code>rejtv_list.js</code> adatfájlból készül. Új rejtvény hozzáadásához elég ezt a fájlt szerkeszteni.</p>
    <div class="top-controls">
      <a class="btn" href="#" onclick="return SMYOZ_goHome(event);">Vissza a főoldalra</a>
      <a class="btn open-vw" data-title="SMYOZ EXPLORER" href="../programok/SMYOZ_EXPLORER.html">EXPLORER</a>
      <!-- SMYOZ: A téma-váltás csak a honlap oldalaira vonatkozik. -->
    </div>
  </header>

  <section class="card">
        <ul class="filelist" id="rootFiles"></ul>
    <div class="footer tech">Megjegyzés: DOCX/XLSX/TXT fájloknál a böngésző jellemzően letölt, és a rendszer alapértelmezett alkalmazása nyitja meg.</div>
  </section>

  <section class="card">
    <h2>Megoldások</h2>
    <div id="items"></div>
    <div class="footer tech">Képek: kattintás a nagyításhoz. Billentyűk nagyításnál: Space / → következő, ← előző, Esc bezár.</div>
  </section>
</div>

<div aria-hidden="true" class="lb" id="lb">
  <div aria-label="Képnéző" aria-modal="true" class="lb-box" role="dialog">
    <div class="lb-top">
      <div class="lb-cap" id="lbCap"></div>
      <div class="lb-actions">
        <button class="lb-btn" id="lbPrev" type="button">← Előző</button>
        <button class="lb-btn" id="lbNext" type="button">Következő →</button>
        <button class="lb-btn" id="lbClose" type="button">Bezár</button>
      </div>
    </div>
    <div class="lb-body">
      <img alt="" id="lbImg"/>
    </div>
  </div>
</div>

<script src="rejtv_list.js"></script>
<script>
(function(){
  'use strict';

  var DATA = window.SMYOZ_REJTV;
  if (!DATA) return;

  var rootUl = document.getElementById('rootFiles');
  var itemsDiv = document.getElementById('items');

  function makeFileLi(file){
    var li = document.createElement('li');

    var a = document.createElement('a');
    a.textContent = file.label;
    a.href = file.href;

    // SMYOZ: PDF: direkt megnyitás (NINCS hátlap/overlay).
    // TXT/MD: VW2 bal 1/3 megjelenítés.
    var kind = String(file.kind || '').toLowerCase();
    var href = String(file.href || '');

    if (kind === 'txt' || kind === 'md') {
      a.className = (a.className ? (a.className + ' ') : '') + 'open-vw';
      a.setAttribute('data-title', file.label || href);
      a.addEventListener('click', function(ev){
        ev.preventDefault();
        if (typeof window.openVW === 'function') window.openVW(href, file.label || href);
      });
    }

    // Direkt megnyitás ugyanabban a fülben (mint a fő indexben)
    // Nincs target=_blank, nincs belső olvasó.
    var kind = String(file.kind || '').toLowerCase();

    var ext = document.createElement('span');
    ext.className = 'ext';
    ext.textContent = kind ? kind.toUpperCase() : '';

    li.appendChild(a);
    li.appendChild(ext);
    return li;
  }

// Root files
  if (rootUl && Array.isArray(DATA.rootFiles)) {
    DATA.rootFiles.forEach(function(f){ rootUl.appendChild(makeFileLi(f)); });
  }

  // Items
  if (itemsDiv && Array.isArray(DATA.items)) {
    DATA.items.forEach(function(item){
      var det = document.createElement('details');
      det.className = 'acc';

      var sum = document.createElement('summary');
      sum.textContent = item.title;

      det.appendChild(sum);

      var body = document.createElement('div');
      body.className = 'acc-body';

      var ul = document.createElement('ul');
      ul.className = 'filelist';

      if (Array.isArray(item.files)) {
        item.files.forEach(function(f){
          ul.appendChild(makeFileLi(f));
        });
      }

      body.appendChild(ul);

      // Gallery
      if (Array.isArray(item.gallery) && item.gallery.length) {
        var grid = document.createElement('div');
        grid.className = 'thumbgrid';
        item.gallery.forEach(function(img, i){
          var btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'thumb';
          btn.setAttribute('data-img', img.src);
          btn.setAttribute('data-caption', img.caption || '');

          var im = document.createElement('img');
          im.alt = img.caption || '';
          im.src = img.src;

          btn.appendChild(im);
          grid.appendChild(btn);
        });
        body.appendChild(grid);
      }

      det.appendChild(body);
      itemsDiv.appendChild(det);
    });
  }

// Lightbox (existing markup)
  var lb = document.getElementById('lb');
  var lbImg = document.getElementById('lbImg');
  var lbCap = document.getElementById('lbCap');
  var btnPrev = document.getElementById('lbPrev');
  var btnNext = document.getElementById('lbNext');
  var btnClose = document.getElementById('lbClose');

  var gallery = [];
  var idx = 0;

  function renderLB(){
    if (!gallery.length) return;
    var it = gallery[idx];
    if (lbImg) { lbImg.src = it.src; lbImg.alt = it.caption || ''; }
    if (lbCap) lbCap.textContent = (idx+1) + '/' + gallery.length + ' — ' + (it.caption || '');
  }

  function openLB(g, startIdx){
    gallery = g.slice();
    idx = Math.max(0, Math.min(startIdx, gallery.length - 1));
    renderLB();
    if (lb) {
      lb.classList.add('on');
      lb.setAttribute('aria-hidden','false');
    }
    document.body.style.overflow = 'hidden';
  }

  function closeLB(){
    if (lb) {
      lb.classList.remove('on');
      lb.setAttribute('aria-hidden','true');
    }
    document.body.style.overflow = '';
    gallery = [];
    idx = 0;
  }

  function nextLB(){
    if (gallery.length < 2) return;
    idx = (idx + 1) % gallery.length;
    renderLB();
  }

  function prevLB(){
    if (gallery.length < 2) return;
    idx = (idx - 1 + gallery.length) % gallery.length;
    renderLB();
  }

  // Build galleries from DOM
  document.querySelectorAll('.thumbgrid').forEach(function(grid){
    var thumbs = Array.prototype.slice.call(grid.querySelectorAll('.thumb'));
    if (!thumbs.length) return;
    var g = thumbs.map(function(t){
      return { src: t.getAttribute('data-img'), caption: t.getAttribute('data-caption') || '' };
    });
    thumbs.forEach(function(t, i){
      t.addEventListener('click', function(){ openLB(g, i); });
    });
  });

  if (btnNext) btnNext.addEventListener('click', nextLB);
  if (btnPrev) btnPrev.addEventListener('click', prevLB);
  if (btnClose) btnClose.addEventListener('click', closeLB);
  if (lb) lb.addEventListener('click', function(e){ if (e.target === lb) closeLB(); });

  document.addEventListener('keydown', function(e){
    if (!lb || !lb.classList.contains('on')) return;
    if (e.key === 'Escape') { e.preventDefault(); closeLB(); return; }
    if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); nextLB(); return; }
    if (e.key === 'ArrowLeft') { e.preventDefault(); prevLB(); return; }
  });

})();
</script>

<script>
function SMYOZ_goHome(ev){
  if (ev) ev.preventDefault();

  function isAbs(u){
    return (u.indexOf('://') !== -1) || (u.indexOf('file:') === 0) || (u.indexOf('http:') === 0) || (u.indexOf('https:') === 0);
  }

  var p;
  try { p = new URLSearchParams(location.search || ''); } catch(e){ p = null; }

  var home = '';
  if (p) home = String(p.get('home') || '');

  // 1) home= paraméter (INDITAS adja át) – lehet abszolút URL vagy relatív fájlnév
  if (home) {
    try { home = decodeURIComponent(home); } catch(e) {}
    if (!isAbs(home) && home.indexOf('/') === -1) home = '../' + home; // pl. INDITAS.html
    location.href = home;
    return false;
  }

  // 2) sessionStorage (azonos origin esetén)
  try{
    var ss = sessionStorage.getItem('SMYOZ_HOME_URL') || '';
    if (ss) { location.href = ss; return false; }
  } catch(e){}

  // 3) referrer, ha van
  if (document.referrer) { location.href = document.referrer; return false; }

  // 4) utolsó mentőöv: offline csomagban INDITAS.html, weben index.html
  var isWeb = (location.protocol === 'http:' || location.protocol === 'https:');
  location.href = isWeb ? '../index.html' : '../INDITAS.html';
  return false;
}
</script>


<div id="vw2" aria-hidden="true">
  <button id="vw2Back" type="button">VISSZA</button>
  <div id="vw2Stage" role="dialog" aria-modal="true" aria-label="Megtekintés">
    <iframe id="vw2Frame" src="about:blank" title="Megtekintés"></iframe>
    <div id="vw2Split">
      <div id="vw2Left"><iframe id="vw2TxtFrame" src="about:blank" title="Szöveg"></iframe></div>
      <div id="vw2Right"></div>
    </div>
  </div>
</div>


<script id="SMYOZ_VW2_JS">
(function(){
  'use strict';

  const vw = document.getElementById('vw2');
  const stage = document.getElementById('vw2Stage');
  const back = document.getElementById('vw2Back');
  const fr = document.getElementById('vw2Frame');
  const split = document.getElementById('vw2Split');
  const tfr = document.getElementById('vw2TxtFrame');

  function closeVW2(){
    vw.classList.remove('txtmode');
    try { fr.src = 'about:blank'; } catch(e) {}
    try { tfr.src = 'about:blank'; } catch(e) {}
    split.classList.remove('on');
    fr.style.display = 'block';
    vw.classList.remove('on');
    vw.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }

  function setStageSize(w, h){
    // A megadott W/H a TARTALOM mérete.
    stage.style.width = String(w) + 'px';
    stage.style.height = String(h) + 'px';
  }

  function programSizeByUrl(url){
    const u = String(url || '');
    const ul = u.toLowerCase().split('#')[0].split('?')[0];
    if (ul.indexOf('smyoz_generator_stat.html') >= 0)   return {w:1440,h:1010};
    if (ul.indexOf('smyoz_generator_manual.html') >= 0) return {w:1270,h:900};
    if (ul.indexOf('smyoz_explorer.html') >= 0)         return {w:1230,h:998};
    return null;
  }

  function addPdfZoom(url){
    const u = String(url || '');
    const ul = u.toLowerCase();
    if (ul.indexOf('.pdf') < 0) return u;
    if (u.indexOf('#') >= 0) return u;
    return u + '#zoom=page-width';
  }

  // Ezt a nevet több helyen használod: felülírjuk, hogy mindig a VW2 menjen.
  window.openVW = function(href, title){
    vw.classList.remove('txtmode');
    if (!href) return false;
    const clean = String(href);
    const lower = clean.toLowerCase().split('#')[0].split('?')[0];

    const isPdf = lower.endsWith('.pdf');
    const isTxt = (lower.endsWith('.txt') || lower.endsWith('.md'));
    const isHtml = lower.endsWith('.html');

    vw.classList.add('on');
    vw.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';

    // alap: PDF 1400×900; TXT 1200×900; Program: fix
    if (isHtml) {
      const psz = programSizeByUrl(clean);
      if (psz) {
        setStageSize(psz.w, psz.h);
      } else {
        setStageSize(1200, 900);
      }
      split.classList.remove('on');
      fr.style.display = 'block';
      fr.src = 'about:blank';
      requestAnimationFrame(function(){ fr.src = clean; });
      return false;
    }

    if (isPdf) {
      setStageSize(1400, 900);
      split.classList.remove('on');
      fr.style.display = 'block';
      fr.src = 'about:blank';
      const u = addPdfZoom(clean);
      requestAnimationFrame(function(){ fr.src = u; });
      return false;
    }

    if (isTxt) {
      // TXT: ne split nézet (ami üres fehér területet okoz), hanem egyetlen iframe, nagyítva
      vw.classList.add('txtmode');
      setStageSize(1400, 900);
      split.classList.remove('on');
      fr.style.display = 'block';
      fr.src = 'about:blank';
      requestAnimationFrame(function(){ fr.src = clean; });
      return false;
    }

    // egyéb: sima iframe
    setStageSize(1200, 900);
    split.classList.remove('on');
    fr.style.display = 'block';
    fr.src = 'about:blank';
    requestAnimationFrame(function(){ fr.src = clean; });
    return false;
  };

  // barna háttérre kattintás = vissza
  vw.addEventListener('click', function(ev){
    if (ev.target === vw) closeVW2();
  });
  back.addEventListener('click', closeVW2);
  document.addEventListener('keydown', function(e){
    if (!vw.classList.contains('on')) return;
    if (e.key === 'Escape') { e.preventDefault(); closeVW2(); }
  });

  // a főoldalon létező .open-vw linkeket ide kötjük, ha van ilyen
  document.addEventListener('click', function(e){
    const a = e.target && e.target.closest ? e.target.closest('a.open-vw') : null;
    if (!a) return;
    const href = a.getAttribute('href');
    const title = a.getAttribute('data-title') || a.textContent || href;
    if (!href) return;
    e.preventDefault();
    window.openVW(href, title);
  });

})();
</script>


<script>
(function(){
  'use strict';
  function addPdfZoomPageWidth(href){
    var u = String(href || '');
    var ul = u.toLowerCase();
    if (ul.indexOf('.pdf') < 0) return u;
    if (u.indexOf('#') >= 0) return u;
    return u + '#zoom=page-width';
  }
  document.addEventListener('click', function(e){
    var a = e.target && e.target.closest ? e.target.closest('a') : null;
    if (!a) return;
    var href = a.getAttribute('href');
    if (!href) return;
    if (String(href).toLowerCase().indexOf('.pdf') < 0) return;
    // hagyjuk a böngészőnek, csak a href-et igazítjuk, ha kell
    var u = addPdfZoomPageWidth(href);
    if (u !== href) a.setAttribute('href', u);
  }, true);
})();
</script>

</body>
</html>
